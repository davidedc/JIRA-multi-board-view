<html>
<body>

<script src="http://code.jquery.com/jquery-1.11.0.min.js"></script>
<script src="http://cdnjs.cloudflare.com/ajax/libs/coffee-script/1.7.1/coffee-script.min.js"></script>


<script type="text/coffeescript">


#
$("input[name='epicgroup']").change ->
  selectedCheckbox = $("input[name='epicgroup']:checked").val()
  if selectedCheckbox is "1"
  	console.log "selected checkbox 1"
  	makeRequestAndUpdateBoard(selectedCheckbox)
  else if selectedCheckbox is "2"
  	console.log "selected checkbox 2"
  	makeRequestAndUpdateBoard(selectedCheckbox)
  return

clearBoards = ->
	for columnNumber in [1...10]
		$( "#column" + columnNumber ).empty()
	$( "#details").empty()


makeRequestAndUpdateBoard = (epicGroupNumber) ->

	$.ajax
		type: 'GET',
		url: './search/something.json',
		dataType: 'jsonp',
		data: {'epicGroupNumber': epicGroupNumber, 'search':'"Epic Link" = SRM-488 or "Epic Link" = SRM-499'},
		success: (responseObject) ->
			# debugger;
			
			clearBoards()
			
			console.log JSON.stringify responseObject

			# We are going to show the equivalent of a JIRA
			# board. Just like JIRA boards, each column can
			# group several statuses, so we model that here.
			groupedStatuses = [
				["Open"], # column 1
				["Prioritised"], # column 2
				["In Development"], # ...
				["In Testing"],
				["Fix soon"],
				["Resolved", "Closed"]
			]

			# add the header in each column, in bold
			# telling which statuses are grouped in it
			groupNumber = 0
			for statusGroup in groupedStatuses
				groupNumber++
				header = ""
				for eachStatus in statusGroup
					header = header + eachStatus + " "
				$( "#column" + groupNumber ).append( "<b>" + header + "<b>" )

			# now add the issues in each column.
			# for each result scan which group it
			# belongs to, according to status, and
			# place in the correct column.
			# Probably not the most efficient way
			# but it's not like we need to place hundreds
			# of issues here, so it's OK
			for i in responseObject.result
				console.log i

				groupNumber = 0
				for statusGroup in groupedStatuses
					groupNumber++
					if i[3] in statusGroup
						# the javascript is just to have the issue details to open
						# in a dedicated div to the right, cause the tiles are
						# probably gonna get real small as we fit more boards
						# in the page
						$( "#column" + groupNumber ).append( "<div onmouseover=\"$('#details').text( $(this).text() );\" >"  + i[1] + ": " + i[2] + "</div> <hr>" )



</script>

Pick an epic group:
</br>
<form action="">
<input type="radio" name="epicgroup" value="1">Epic 1 ( SRM-488 , SRM-499 )<br>
<input type="radio" name="epicgroup" value="2">Epic 2 ( SRM-567 , SRM-568 )<br>
</form>
</br>

<hr>

<div id="column1"  style="float: left; width:100px"> </div>
<div id="column2"  style="float: left; width:100px"> </div>
<div id="column3"  style="float: left; width:100px"> </div>
<div id="column4"  style="float: left; width:100px"> </div>
<div id="column5"  style="float: left; width:100px"> </div>
<div id="column6"  style="float: left; width:100px"> </div>
<div id="column7"  style="float: left; width:100px"> </div>
<div id="column8"  style="float: left; width:100px"> </div>
<div id="column9"  style="float: left; width:100px"> </div>
<div id="column10" style="float: left; width:100px"> </div>

<div id="details" style="float: left; width:100px"> </div>

</body>
</html>
